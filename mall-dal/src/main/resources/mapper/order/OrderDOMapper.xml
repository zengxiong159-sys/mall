<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.qdbank.mall.mapper.order.OrderDOMapper">
  <resultMap id="BaseResultMap" type="com.qdbank.mall.model.order.OrderDO">
    <result column="ORDER_ID" jdbcType="DECIMAL" property="orderId" />
    <result column="CUST_NO" jdbcType="DECIMAL" property="custNo" />
    <result column="CUST_NAME" jdbcType="VARCHAR" property="custName" />
    <result column="CUST_MOBILE" jdbcType="DECIMAL" property="custMobile" />
    <result column="MERCHANT_NO" jdbcType="DECIMAL" property="merchantNo" />
    <result column="MERCHANT_NAME" jdbcType="VARCHAR" property="merchantName" />
    <result column="ORDER_SN" jdbcType="VARCHAR" property="orderSn" />
    <result column="PRODUCT_ID" jdbcType="DECIMAL" property="productId" />
    <result column="PRODUCT_NAME" jdbcType="VARCHAR" property="productName" />
    <result column="PRODUCT_SKU_ID" jdbcType="DECIMAL" property="productSkuId" />
    <result column="PRODUCT_COUNT" jdbcType="DECIMAL" property="productCount" />
    <result column="PRODUCT_PRICE" jdbcType="DECIMAL" property="productPrice" />
    <result column="PRODUCT_CASH" jdbcType="DECIMAL" property="productCash" />
    <result column="PRODUCT_INTEGRATION" jdbcType="DECIMAL" property="productIntegration" />
    <result column="CATEGORY_ID_1" jdbcType="DECIMAL" property="categoryId1" />
    <result column="CATEGORY_ID_2" jdbcType="DECIMAL" property="categoryId2" />
    <result column="CATEGORY_ID_3" jdbcType="DECIMAL" property="categoryId3" />
    <result column="CATEGORY_ID_4" jdbcType="DECIMAL" property="categoryId4" />
    <result column="PAY_AMOUNT" jdbcType="DECIMAL" property="payAmount" />
    <result column="ORDER_CASH" jdbcType="DECIMAL" property="orderCash" />
    <result column="ORDER_INTEGRATION" jdbcType="DECIMAL" property="orderIntegration" />
    <result column="FREIGHT_AMOUNT" jdbcType="DECIMAL" property="freightAmount" />
    <result column="USER_COUPON_ID" jdbcType="DECIMAL" property="userCouponId" />
    <result column="COUPON_TYPE" jdbcType="DECIMAL" property="couponType" />
    <result column="COUPON_AMOUNT" jdbcType="DECIMAL" property="couponAmount" />
    <result column="PAY_TYPE" jdbcType="DECIMAL" property="payType" />
    <result column="STATUS" jdbcType="DECIMAL" property="status" />
    <result column="CLOSE_TYPE" jdbcType="DECIMAL" property="closeType" />
    <result column="REFUND_STATUS" jdbcType="DECIMAL" property="refundStatus" />
    <result column="REFUND_SERIAL" jdbcType="VARCHAR" property="refundSerialNo" />
    <result column="PRODUCT_TYPE" jdbcType="DECIMAL" property="productType" />
    <result column="DELIVERY_COMPANY_NAME" jdbcType="VARCHAR" property="deliveryCompanyName" />
    <result column="DELIVERY_SN" jdbcType="VARCHAR" property="deliverySn" />
    <result column="RECEIVER_NAME" jdbcType="VARCHAR" property="receiverName" />
    <result column="RECEIVER_PHONE" jdbcType="VARCHAR" property="receiverPhone" />
    <result column="RECEIVER_PROVINCE" jdbcType="VARCHAR" property="receiverProvince" />
    <result column="RECEIVER_CITY" jdbcType="VARCHAR" property="receiverCity" />
    <result column="RECEIVER_REGION" jdbcType="VARCHAR" property="receiverRegion" />
    <result column="RECEIVER_DETAIL_ADDRESS" jdbcType="VARCHAR" property="receiverDetailAddress" />
    <result column="NOTE" jdbcType="VARCHAR" property="note" />
    <result column="CONFIRM_STATUS" jdbcType="DECIMAL" property="confirmStatus" />
    <result column="INTEGRATION_PAY_FLAG" jdbcType="DECIMAL" property="integrationPayFlag" />
    <result column="PAYMENT_TIME" jdbcType="TIMESTAMP" property="paymentTime" />
    <result column="DELIVERY_TIME" jdbcType="TIMESTAMP" property="deliveryTime" />
    <result column="RECEIVE_TIME" jdbcType="TIMESTAMP" property="receiveTime" />
    <result column="RECHARGE_ACCT_NO" jdbcType="VARCHAR" property="rechargeMobile" />
    <result column="MOBILE_ADDRESS" jdbcType="VARCHAR" property="mobileAddress" />
    <result column="NOTICE_STATUS" jdbcType="DECIMAL" property="noticeStatus" />
    <result column="CREATE_TIME" jdbcType="TIMESTAMP" property="createTime" />
    <result column="UPDATE_TIME" jdbcType="TIMESTAMP" property="updateTime" />
    <result column="REQ_URL" jdbcType="VARCHAR" property="reqUrl" />
    <result column="ACCESS_SIGN_ID" jdbcType="VARCHAR" property="accessSignId" />
    <result column="EXCHANGE_COUPON_ID" jdbcType="DECIMAL" property="exchangeCouponId" />
    <result column="RECHARGE_REMARK" jdbcType="VARCHAR" property="rechargeRemark" />
    <result column="RECHARGE_SEQ" jdbcType="VARCHAR" property="rechargeSeq" />
    <result column="INTEGRAL_DEDUCT" jdbcType="DECIMAL" property="integralDeduct"/>
    <result column="RECHARGE_ACCT_NO" jdbcType="VARCHAR" property="rechargeAccNo"/>
    <result column="DISCOUNT_AMOUNT" jdbcType="DECIMAL" property="discountAmount"/>
  </resultMap>


  <resultMap id="BaseDetailsMap" type="com.qdbank.mall.model.order.OrderDetailsDO" extends="BaseResultMap">
    <association property="orderRefundDO" javaType="com.qdbank.mall.model.orderrefund.OrderRefundDO" >
      <result column="REFUND_CREATE_TIME" jdbcType="TIMESTAMP" property="createTime" />
      <result column="REFUND_SERIAL" jdbcType="VARCHAR" property="refundSerial" />
      <result column="REFUND_REFUND_STATUS" jdbcType="DECIMAL" property="refundStatus" />
      <result column="REFUND_TYPE" jdbcType="DECIMAL" property="refundType" />
      <result column="REFUND_AMOUNT" jdbcType="DECIMAL" property="refundAmount" />
    </association>
    <association property="couponDO" javaType="com.qdbank.mall.model.coupon.CouponDO">
      <result column="COUPON_NAME" jdbcType="VARCHAR" property="couponName" />
      <result column="COUPON_COUPON_TYPE" jdbcType="DECIMAL" property="couponType" />
      <result column="BATCH_NO" jdbcType="VARCHAR" property="batchNo" />
      <result column="COUPON_ID" jdbcType="DECIMAL" property="couponId" />
      <result column="COUPON_COUPON_AMOUNT" jdbcType="DECIMAL" property="couponAmount" />
    </association>
    <association property="productDO" javaType="com.qdbank.mall.model.product.ProductDO">
      <result column="P_PRODUCT_NAME" jdbcType="VARCHAR" property="productName" />
      <result column="P_MERCHANT_NAME" jdbcType="VARCHAR" property="merchantName" />
      <result column="MAIL_PIC_URL" jdbcType="VARCHAR" property="mailPicUrl" />
    </association>
    <association property="skustockDO" javaType="com.qdbank.mall.model.skustock.SkustockDO">
      <result column="PRODUCT_SP_DATA" jdbcType="VARCHAR" property="productSpData" />
    </association>
    <collection property="rechargeStatusDOS" ofType="com.qdbank.mall.model.rechargestatusdetail.RechargeStatusDO">
      <result column="DETAIL_CREATE_TIME" jdbcType="TIMESTAMP" property="createTime" />
      <result column="DETAIL_STATUS" jdbcType="DECIMAL" property="status" />
    </collection>
  </resultMap>
  <resultMap id="OrderCouponDetailResultMap" type="com.qdbank.mall.model.order.OrderCouponDetailDO" extends="com.qdbank.mall.mapper.order.OrderDOMapper.BaseResultMap">
    <collection property="rechargeStatusDOS" resultMap="com.qdbank.mall.mapper.rechargestatusdetail.RechargeStatusDOMapper.BaseResultMap" columnPrefix="rech_"/>
  </resultMap>
  <resultMap id="BaseListMap" type="com.qdbank.mall.model.order.OrderListDO" extends="BaseResultMap">
    <association property="skustockDO" javaType="com.qdbank.mall.model.skustock.SkustockDO" >
      <result column="PRODUCT_SP_DATA" jdbcType="VARCHAR" property="productSpData" />
      <result column="SKU_PIC_URL" jdbcType="VARCHAR" property="skuPicUrl" />
    </association>
  </resultMap>

  <resultMap id="BaseOrderMap" type="com.qdbank.mall.model.order.OrderExportDO" extends="BaseResultMap">
    <result column="PRODUCT_SP_DATA" jdbcType="VARCHAR" property="productSpData" />
    <result column="REFUND_SERIAL" jdbcType="VARCHAR" property="refundSerial" />
    <result column="IDENTIFICATION" jdbcType="DECIMAL" property="identification"/>
  </resultMap>


  <resultMap id="OrderRefundDetailsMap" type="com.qdbank.mall.model.order.OrderAndRefundDetailDO" extends="BaseResultMap">
    <id column="REFUND_SERIAL" jdbcType="VARCHAR" property="refundSerial" />
    <result column="REFUND_AMOUNT" jdbcType="DECIMAL" property="refundAmount" />
    <result column="REFUND_CASH" jdbcType="DECIMAL" property="refundCash" />
    <result column="FREIGHT_AMOUNT" jdbcType="DECIMAL" property="freightAmount" />
    <result column="REFUND_INTEGRATION" jdbcType="DECIMAL" property="refundIntegration" />
    <result column="REFUND_STATUS" jdbcType="DECIMAL" property="refundStatus" />
    <result column="HANDLE_START_TIME" jdbcType="TIMESTAMP" property="handleStartTime" />
    <result column="HANDLE_FINISH_TIME" jdbcType="TIMESTAMP" property="handleFinishTime" />
    <result column="HANDLE_RESULT" jdbcType="DECIMAL" property="handleResult" />
    <result column="REASON" jdbcType="VARCHAR" property="reason" />
    <result column="REFUND_TYPE" jdbcType="DECIMAL" property="refundType" />
    <result column="PROOF_PICS" jdbcType="VARCHAR" property="proofPics" />
    <result column="ADMIN_NAME" jdbcType="VARCHAR" property="adminName" />
    <result column="EMAIL" jdbcType="VARCHAR" property="email" />
    <result column="REFUND_NOTE" jdbcType="VARCHAR" property="refundNote" />
    <result column="REFUND_CREATE_TIME" jdbcType="TIMESTAMP" property="refundCreateTime" />
    <result column="REFUND_REFUND_STATUS" jdbcType="DECIMAL" property="refundStatus1" />
  </resultMap>

  <sql id="Example_Where_Clause">
    <where>
      <foreach collection="oredCriteria" item="criteria" separator="or">
        <if test="criteria.valid">
          <trim prefix="(" prefixOverrides="and" suffix=")">
            <foreach collection="criteria.criteria" item="criterion">
              <choose>
                <when test="criterion.noValue">
                  and ${criterion.condition}
                </when>
                <when test="criterion.singleValue">
                  and ${criterion.condition} #{criterion.value}
                </when>
                <when test="criterion.betweenValue">
                  and ${criterion.condition} #{criterion.value} and #{criterion.secondValue}
                </when>
                <when test="criterion.listValue">
                  and ${criterion.condition}
                  <foreach close=")" collection="criterion.value" item="listItem" open="(" separator=",">
                    #{listItem}
                  </foreach>
                </when>
              </choose>
            </foreach>
          </trim>
        </if>
      </foreach>
    </where>
  </sql>
  <sql id="Update_By_Example_Where_Clause">
    <where>
      <foreach collection="example.oredCriteria" item="criteria" separator="or">
        <if test="criteria.valid">
          <trim prefix="(" prefixOverrides="and" suffix=")">
            <foreach collection="criteria.criteria" item="criterion">
              <choose>
                <when test="criterion.noValue">
                  and ${criterion.condition}
                </when>
                <when test="criterion.singleValue">
                  and ${criterion.condition} #{criterion.value}
                </when>
                <when test="criterion.betweenValue">
                  and ${criterion.condition} #{criterion.value} and #{criterion.secondValue}
                </when>
                <when test="criterion.listValue">
                  and ${criterion.condition}
                  <foreach close=")" collection="criterion.value" item="listItem" open="(" separator=",">
                    #{listItem}
                  </foreach>
                </when>
              </choose>
            </foreach>
          </trim>
        </if>
      </foreach>
    </where>
  </sql>
  <sql id="Base_Column_List">
    ORDER_ID, CUST_NO, CUST_NAME, CUST_MOBILE, MERCHANT_NO, MERCHANT_NAME, ORDER_SN, 
    PRODUCT_ID, PRODUCT_NAME, PRODUCT_SKU_ID, PRODUCT_COUNT, PRODUCT_PRICE, PRODUCT_CASH, 
    PRODUCT_INTEGRATION, CATEGORY_ID_1, CATEGORY_ID_2, CATEGORY_ID_3, CATEGORY_ID_4, 
    PAY_AMOUNT, ORDER_CASH, ORDER_INTEGRATION, FREIGHT_AMOUNT, USER_COUPON_ID, COUPON_TYPE, 
    COUPON_AMOUNT, PAY_TYPE, STATUS, CLOSE_TYPE, REFUND_STATUS, PRODUCT_TYPE, DELIVERY_COMPANY_NAME, 
    DELIVERY_SN, RECEIVER_NAME, RECEIVER_PHONE, RECEIVER_PROVINCE, RECEIVER_CITY, RECEIVER_REGION, 
    RECEIVER_DETAIL_ADDRESS, NOTE, CONFIRM_STATUS, INTEGRATION_PAY_FLAG, PAYMENT_TIME, 
    DELIVERY_TIME, RECEIVE_TIME, RECHARGE_ACCT_NO, MOBILE_ADDRESS, NOTICE_STATUS, CREATE_TIME,
    UPDATE_TIME, REQ_URL, ACCESS_SIGN_ID, EXCHANGE_COUPON_ID, RECHARGE_REMARK, RECHARGE_SEQ,INTEGRAL_DEDUCT,DISCOUNT_AMOUNT
  </sql>
  <select id="selectByExample" parameterType="com.qdbank.mall.model.order.OrderDOExample" resultMap="BaseResultMap">
    select
    <if test="distinct">
      distinct
    </if>
    'true' as QUERYID,
    <include refid="Base_Column_List" />
    from OMS_ORDER
    <if test="_parameter != null">
      <include refid="Example_Where_Clause" />
    </if>
    <if test="orderByClause != null">
      order by ${orderByClause}
    </if>
  </select>
  <delete id="deleteByExample" parameterType="com.qdbank.mall.model.order.OrderDOExample">
    delete from OMS_ORDER
    <if test="_parameter != null">
      <include refid="Example_Where_Clause" />
    </if>
  </delete>
  <insert id="insert" parameterType="com.qdbank.mall.model.order.OrderDO">
    insert into OMS_ORDER (ORDER_ID, CUST_NO, CUST_NAME,
      CUST_MOBILE, MERCHANT_NO, MERCHANT_NAME, 
      ORDER_SN, PRODUCT_ID, PRODUCT_NAME, 
      PRODUCT_SKU_ID, PRODUCT_COUNT, PRODUCT_PRICE, 
      PRODUCT_CASH, PRODUCT_INTEGRATION, CATEGORY_ID_1, 
      CATEGORY_ID_2, CATEGORY_ID_3, CATEGORY_ID_4, 
      PAY_AMOUNT, ORDER_CASH, ORDER_INTEGRATION, 
      FREIGHT_AMOUNT, USER_COUPON_ID, COUPON_TYPE, 
      COUPON_AMOUNT, PAY_TYPE, STATUS, 
      CLOSE_TYPE, REFUND_STATUS, PRODUCT_TYPE, 
      DELIVERY_COMPANY_NAME, DELIVERY_SN, RECEIVER_NAME, 
      RECEIVER_PHONE, RECEIVER_PROVINCE, RECEIVER_CITY,
      RECEIVER_REGION, RECEIVER_DETAIL_ADDRESS, 
      NOTE, CONFIRM_STATUS, INTEGRATION_PAY_FLAG, 
      PAYMENT_TIME, DELIVERY_TIME, RECEIVE_TIME, 
      RECHARGE_ACCT_NO, MOBILE_ADDRESS, NOTICE_STATUS,
      CREATE_TIME, UPDATE_TIME, REQ_URL, 
      ACCESS_SIGN_ID, EXCHANGE_COUPON_ID, RECHARGE_REMARK, 
      RECHARGE_SEQ,INTEGRAL_DEDUCT,DISCOUNT_AMOUNT)
    values (#{orderId,jdbcType=DECIMAL}, #{custNo,jdbcType=DECIMAL}, #{custName,jdbcType=VARCHAR}, 
      #{custMobile,jdbcType=DECIMAL}, #{merchantNo,jdbcType=DECIMAL}, #{merchantName,jdbcType=VARCHAR}, 
      #{orderSn,jdbcType=VARCHAR}, #{productId,jdbcType=DECIMAL}, #{productName,jdbcType=VARCHAR}, 
      #{productSkuId,jdbcType=DECIMAL}, #{productCount,jdbcType=DECIMAL}, #{productPrice,jdbcType=DECIMAL}, 
      #{productCash,jdbcType=DECIMAL}, #{productIntegration,jdbcType=DECIMAL}, #{categoryId1,jdbcType=DECIMAL}, 
      #{categoryId2,jdbcType=DECIMAL}, #{categoryId3,jdbcType=DECIMAL}, #{categoryId4,jdbcType=DECIMAL}, 
      #{payAmount,jdbcType=DECIMAL}, #{orderCash,jdbcType=DECIMAL}, #{orderIntegration,jdbcType=DECIMAL}, 
      #{freightAmount,jdbcType=DECIMAL}, #{userCouponId,jdbcType=DECIMAL}, #{couponType,jdbcType=DECIMAL}, 
      #{couponAmount,jdbcType=DECIMAL}, #{payType,jdbcType=DECIMAL}, #{status,jdbcType=DECIMAL}, 
      #{closeType,jdbcType=DECIMAL}, #{refundStatus,jdbcType=DECIMAL}, #{productType,jdbcType=DECIMAL}, 
      #{deliveryCompanyName,jdbcType=VARCHAR}, #{deliverySn,jdbcType=VARCHAR}, #{receiverName,jdbcType=VARCHAR}, 
      #{receiverPhone,jdbcType=VARCHAR}, #{receiverProvince,jdbcType=VARCHAR}, #{receiverCity,jdbcType=VARCHAR}, 
      #{receiverRegion,jdbcType=VARCHAR}, #{receiverDetailAddress,jdbcType=VARCHAR}, 
      #{note,jdbcType=VARCHAR}, #{confirmStatus,jdbcType=DECIMAL}, #{integrationPayFlag,jdbcType=DECIMAL}, 
      #{paymentTime,jdbcType=TIMESTAMP}, #{deliveryTime,jdbcType=TIMESTAMP}, #{receiveTime,jdbcType=TIMESTAMP},
      #{rechargeMobile,jdbcType=VARCHAR}, #{mobileAddress,jdbcType=VARCHAR}, #{noticeStatus,jdbcType=DECIMAL},
      #{createTime,jdbcType=TIMESTAMP}, #{updateTime,jdbcType=TIMESTAMP}, #{reqUrl,jdbcType=VARCHAR}, 
      #{accessSignId,jdbcType=VARCHAR}, #{exchangeCouponId,jdbcType=DECIMAL}, #{rechargeRemark,jdbcType=VARCHAR}, 
      #{rechargeSeq,jdbcType=VARCHAR},#{integralDeduct,jdbcType=DECIMAL},#{discountAmount,jdbcType=DECIMAL})
  </insert>
  <insert id="insertSelective" parameterType="com.qdbank.mall.model.order.OrderDO">
    insert into OMS_ORDER
    <trim prefix="(" suffix=")" suffixOverrides=",">
      <if test="orderId != null">
        ORDER_ID,
      </if>
      <if test="custNo != null">
        CUST_NO,
      </if>
      <if test="custName != null">
        CUST_NAME,
      </if>
      <if test="custMobile != null">
        CUST_MOBILE,
      </if>
      <if test="merchantNo != null">
        MERCHANT_NO,
      </if>
      <if test="merchantName != null">
        MERCHANT_NAME,
      </if>
      <if test="orderSn != null">
        ORDER_SN,
      </if>
      <if test="productId != null">
        PRODUCT_ID,
      </if>
      <if test="productName != null">
        PRODUCT_NAME,
      </if>
      <if test="productSkuId != null">
        PRODUCT_SKU_ID,
      </if>
      <if test="productCount != null">
        PRODUCT_COUNT,
      </if>
      <if test="productPrice != null">
        PRODUCT_PRICE,
      </if>
      <if test="productCash != null">
        PRODUCT_CASH,
      </if>
      <if test="productIntegration != null">
        PRODUCT_INTEGRATION,
      </if>
      <if test="categoryId1 != null">
        CATEGORY_ID_1,
      </if>
      <if test="categoryId2 != null">
        CATEGORY_ID_2,
      </if>
      <if test="categoryId3 != null">
        CATEGORY_ID_3,
      </if>
      <if test="categoryId4 != null">
        CATEGORY_ID_4,
      </if>
      <if test="payAmount != null">
        PAY_AMOUNT,
      </if>
      <if test="orderCash != null">
        ORDER_CASH,
      </if>
      <if test="orderIntegration != null">
        ORDER_INTEGRATION,
      </if>
      <if test="freightAmount != null">
        FREIGHT_AMOUNT,
      </if>
      <if test="userCouponId != null">
        USER_COUPON_ID,
      </if>
      <if test="couponType != null">
        COUPON_TYPE,
      </if>
      <if test="couponAmount != null">
        COUPON_AMOUNT,
      </if>
      <if test="payType != null">
        PAY_TYPE,
      </if>
      <if test="status != null">
        STATUS,
      </if>
      <if test="closeType != null">
        CLOSE_TYPE,
      </if>
      <if test="refundStatus != null">
        REFUND_STATUS,
      </if>
      <if test="productType != null">
        PRODUCT_TYPE,
      </if>
      <if test="deliveryCompanyName != null">
        DELIVERY_COMPANY_NAME,
      </if>
      <if test="deliverySn != null">
        DELIVERY_SN,
      </if>
      <if test="receiverName != null">
        RECEIVER_NAME,
      </if>
      <if test="receiverPhone != null">
        RECEIVER_PHONE,
      </if>
      <if test="receiverProvince != null">
        RECEIVER_PROVINCE,
      </if>
      <if test="receiverCity != null">
        RECEIVER_CITY,
      </if>
      <if test="receiverRegion != null">
        RECEIVER_REGION,
      </if>
      <if test="receiverDetailAddress != null">
        RECEIVER_DETAIL_ADDRESS,
      </if>
      <if test="note != null">
        NOTE,
      </if>
      <if test="confirmStatus != null">
        CONFIRM_STATUS,
      </if>
      <if test="integrationPayFlag != null">
        INTEGRATION_PAY_FLAG,
      </if>
      <if test="paymentTime != null">
        PAYMENT_TIME,
      </if>
      <if test="deliveryTime != null">
        DELIVERY_TIME,
      </if>
      <if test="receiveTime != null">
        RECEIVE_TIME,
      </if>
      <if test="rechargeMobile != null">
        RECHARGE_ACCT_NO,
      </if>
      <if test="mobileAddress != null">
        MOBILE_ADDRESS,
      </if>
      <if test="noticeStatus != null">
        NOTICE_STATUS,
      </if>
      <if test="createTime != null">
        CREATE_TIME,
      </if>
      <if test="updateTime != null">
        UPDATE_TIME,
      </if>
      <if test="reqUrl != null">
        REQ_URL,
      </if>
      <if test="accessSignId != null">
        ACCESS_SIGN_ID,
      </if>
      <if test="exchangeCouponId != null">
        EXCHANGE_COUPON_ID,
      </if>
      <if test="rechargeRemark != null">
        RECHARGE_REMARK,
      </if>
      <if test="rechargeSeq != null">
        RECHARGE_SEQ,
      </if>
    </trim>
    <trim prefix="values (" suffix=")" suffixOverrides=",">
      <if test="orderId != null">
        #{orderId,jdbcType=DECIMAL},
      </if>
      <if test="custNo != null">
        #{custNo,jdbcType=DECIMAL},
      </if>
      <if test="custName != null">
        #{custName,jdbcType=VARCHAR},
      </if>
      <if test="custMobile != null">
        #{custMobile,jdbcType=DECIMAL},
      </if>
      <if test="merchantNo != null">
        #{merchantNo,jdbcType=DECIMAL},
      </if>
      <if test="merchantName != null">
        #{merchantName,jdbcType=VARCHAR},
      </if>
      <if test="orderSn != null">
        #{orderSn,jdbcType=VARCHAR},
      </if>
      <if test="productId != null">
        #{productId,jdbcType=DECIMAL},
      </if>
      <if test="productName != null">
        #{productName,jdbcType=VARCHAR},
      </if>
      <if test="productSkuId != null">
        #{productSkuId,jdbcType=DECIMAL},
      </if>
      <if test="productCount != null">
        #{productCount,jdbcType=DECIMAL},
      </if>
      <if test="productPrice != null">
        #{productPrice,jdbcType=DECIMAL},
      </if>
      <if test="productCash != null">
        #{productCash,jdbcType=DECIMAL},
      </if>
      <if test="productIntegration != null">
        #{productIntegration,jdbcType=DECIMAL},
      </if>
      <if test="categoryId1 != null">
        #{categoryId1,jdbcType=DECIMAL},
      </if>
      <if test="categoryId2 != null">
        #{categoryId2,jdbcType=DECIMAL},
      </if>
      <if test="categoryId3 != null">
        #{categoryId3,jdbcType=DECIMAL},
      </if>
      <if test="categoryId4 != null">
        #{categoryId4,jdbcType=DECIMAL},
      </if>
      <if test="payAmount != null">
        #{payAmount,jdbcType=DECIMAL},
      </if>
      <if test="orderCash != null">
        #{orderCash,jdbcType=DECIMAL},
      </if>
      <if test="orderIntegration != null">
        #{orderIntegration,jdbcType=DECIMAL},
      </if>
      <if test="freightAmount != null">
        #{freightAmount,jdbcType=DECIMAL},
      </if>
      <if test="userCouponId != null">
        #{userCouponId,jdbcType=DECIMAL},
      </if>
      <if test="couponType != null">
        #{couponType,jdbcType=DECIMAL},
      </if>
      <if test="couponAmount != null">
        #{couponAmount,jdbcType=DECIMAL},
      </if>
      <if test="payType != null">
        #{payType,jdbcType=DECIMAL},
      </if>
      <if test="status != null">
        #{status,jdbcType=DECIMAL},
      </if>
      <if test="closeType != null">
        #{closeType,jdbcType=DECIMAL},
      </if>
      <if test="refundStatus != null">
        #{refundStatus,jdbcType=DECIMAL},
      </if>
      <if test="productType != null">
        #{productType,jdbcType=DECIMAL},
      </if>
      <if test="deliveryCompanyName != null">
        #{deliveryCompanyName,jdbcType=VARCHAR},
      </if>
      <if test="deliverySn != null">
        #{deliverySn,jdbcType=VARCHAR},
      </if>
      <if test="receiverName != null">
        #{receiverName,jdbcType=VARCHAR},
      </if>
      <if test="receiverPhone != null">
        #{receiverPhone,jdbcType=VARCHAR},
      </if>
      <if test="receiverProvince != null">
        #{receiverProvince,jdbcType=VARCHAR},
      </if>
      <if test="receiverCity != null">
        #{receiverCity,jdbcType=VARCHAR},
      </if>
      <if test="receiverRegion != null">
        #{receiverRegion,jdbcType=VARCHAR},
      </if>
      <if test="receiverDetailAddress != null">
        #{receiverDetailAddress,jdbcType=VARCHAR},
      </if>
      <if test="note != null">
        #{note,jdbcType=VARCHAR},
      </if>
      <if test="confirmStatus != null">
        #{confirmStatus,jdbcType=DECIMAL},
      </if>
      <if test="integrationPayFlag != null">
        #{integrationPayFlag,jdbcType=DECIMAL},
      </if>
      <if test="paymentTime != null">
        #{paymentTime,jdbcType=TIMESTAMP},
      </if>
      <if test="deliveryTime != null">
        #{deliveryTime,jdbcType=TIMESTAMP},
      </if>
      <if test="receiveTime != null">
        #{receiveTime,jdbcType=TIMESTAMP},
      </if>
      <if test="rechargeMobile != null">
        #{rechargeMobile,jdbcType=VARCHAR},
      </if>
      <if test="mobileAddress != null">
        #{mobileAddress,jdbcType=VARCHAR},
      </if>
      <if test="noticeStatus != null">
        #{noticeStatus,jdbcType=DECIMAL},
      </if>
      <if test="createTime != null">
        #{createTime,jdbcType=TIMESTAMP},
      </if>
      <if test="updateTime != null">
        #{updateTime,jdbcType=TIMESTAMP},
      </if>
      <if test="reqUrl != null">
        #{reqUrl,jdbcType=VARCHAR},
      </if>
      <if test="accessSignId != null">
        #{accessSignId,jdbcType=VARCHAR},
      </if>
      <if test="exchangeCouponId != null">
        #{exchangeCouponId,jdbcType=DECIMAL},
      </if>
      <if test="rechargeRemark != null">
        #{rechargeRemark,jdbcType=VARCHAR},
      </if>
      <if test="rechargeSeq != null">
        #{rechargeSeq,jdbcType=VARCHAR},
      </if>
    </trim>
  </insert>
  <select id="countByExample" parameterType="com.qdbank.mall.model.order.OrderDOExample" resultType="java.lang.Long">
    select count(*) from OMS_ORDER
    <if test="_parameter != null">
      <include refid="Example_Where_Clause" />
    </if>
  </select>

  <select id="selectList" parameterType="com.qdbank.mall.model.order.OrderLikeQueryDO" resultMap="BaseListMap">
    select
    r.*,
    k.product_sp_data,
    k.sku_pic_url
    from oms_order r
    left join pms_sku_stock k on r.product_sku_id = k.product_sku_id
    where 1=1
    <if test="productName != null and productName != ''">
      and r.PRODUCT_NAME like  '%' || #{productName,jdbcType=VARCHAR} || '%'
    </if>
    <if test="categoryId2 != null">
      and r.CATEGORY_ID_2 =#{categoryId2,jdbcType = DECIMAL}
    </if>
    <if test="merchantNo != null">
      and r.MERCHANT_NO =#{merchantNo,jdbcType = DECIMAL}
    </if>
    <if test="merchantName != null and merchantName != ''">
      and r.MERCHANT_NAME like  '%' || #{merchantName,jdbcType=VARCHAR} || '%'
    </if>
    <if test="productType != null">
      and r.PRODUCT_TYPE = #{productType,jdbcType = DECIMAL}
    </if>
    <if test="orderSn != null and orderSn != ''">
      and r.ORDER_SN =#{orderSn,jdbcType=VARCHAR}
    </if>
    <if test="custMobile != null">
      and r.CUST_MOBILE =#{custMobile,jdbcType=DECIMAL}
    </if>
    <if test="status != null">
      and r.STATUS =#{status,jdbcType =DECIMAL}
    </if>
    <if test="startTime != null">
      and r.CREATE_TIME &gt;=#{startTime,jdbcType =TIMESTAMP}
    </if>
    <if test="closeType != null">
      and r.CLOSE_TYPE =#{closeType,jdbcType =DECIMAL}
    </if>
    <if test="endTime != null">
      and r.CREATE_TIME &lt;=#{endTime,jdbcType =TIMESTAMP}
    </if>
    order by r.CREATE_TIME desc
  </select>

  <select id="selectOrderByOrderSn" parameterType="com.qdbank.mall.model.order.OrderDO" resultMap="BaseResultMap">
    select
    <include refid="Base_Column_List" />
    from OMS_ORDER
    where 1=1
    <if test="record.orderSn != null">
     and ORDER_SN = #{record.orderSn,jdbcType=VARCHAR}
    </if>
  </select>

  <update id="updateByOrderId" parameterType="com.qdbank.mall.model.order.OrderDO">
    update OMS_ORDER
    <set>
      <if test="record.orderId != null">
        ORDER_ID = #{record.orderId,jdbcType=DECIMAL},
      </if>
      <if test="record.custNo != null">
        CUST_NO = #{record.custNo,jdbcType=DECIMAL},
      </if>
      <if test="record.custName != null">
        CUST_NAME = #{record.custName,jdbcType=VARCHAR},
      </if>
      <if test="record.custMobile != null">
        CUST_MOBILE = #{record.custMobile,jdbcType=DECIMAL},
      </if>
      <if test="record.merchantNo != null">
        MERCHANT_NO = #{record.merchantNo,jdbcType=DECIMAL},
      </if>
      <if test="record.merchantName != null">
        MERCHANT_NAME = #{record.merchantName,jdbcType=VARCHAR},
      </if>
      <if test="record.orderSn != null">
        ORDER_SN = #{record.orderSn,jdbcType=VARCHAR},
      </if>
      <if test="record.productId != null">
        PRODUCT_ID = #{record.productId,jdbcType=DECIMAL},
      </if>
      <if test="record.productName != null">
        PRODUCT_NAME = #{record.productName,jdbcType=VARCHAR},
      </if>
      <if test="record.productSkuId != null">
        PRODUCT_SKU_ID = #{record.productSkuId,jdbcType=DECIMAL},
      </if>
      <if test="record.productCount != null">
        PRODUCT_COUNT = #{record.productCount,jdbcType=DECIMAL},
      </if>
      <if test="record.productPrice != null">
        PRODUCT_PRICE = #{record.productPrice,jdbcType=DECIMAL},
      </if>
      <if test="record.productCash != null">
        PRODUCT_CASH = #{record.productCash,jdbcType=DECIMAL},
      </if>
      <if test="record.productIntegration != null">
        PRODUCT_INTEGRATION = #{record.productIntegration,jdbcType=DECIMAL},
      </if>
      <if test="record.categoryId1 != null">
        CATEGORY_ID_1 = #{record.categoryId1,jdbcType=DECIMAL},
      </if>
      <if test="record.categoryId2 != null">
        CATEGORY_ID_2 = #{record.categoryId2,jdbcType=DECIMAL},
      </if>
      <if test="record.categoryId3 != null">
        CATEGORY_ID_3 = #{record.categoryId3,jdbcType=DECIMAL},
      </if>
      <if test="record.categoryId4 != null">
        CATEGORY_ID_4 = #{record.categoryId4,jdbcType=DECIMAL},
      </if>
      <if test="record.payAmount != null">
        PAY_AMOUNT = #{record.payAmount,jdbcType=DECIMAL},
      </if>
      <if test="record.orderCash != null">
        ORDER_CASH = #{record.orderCash,jdbcType=DECIMAL},
      </if>
      <if test="record.orderIntegration != null">
        ORDER_INTEGRATION = #{record.orderIntegration,jdbcType=DECIMAL},
      </if>
      <if test="record.freightAmount != null">
        FREIGHT_AMOUNT = #{record.freightAmount,jdbcType=DECIMAL},
      </if>
      <if test="record.userCouponId != null">
        USER_COUPON_ID = #{record.userCouponId,jdbcType=DECIMAL},
      </if>
      <if test="record.couponType != null">
        COUPON_TYPE = #{record.couponType,jdbcType=DECIMAL},
      </if>
      <if test="record.couponAmount != null">
        COUPON_AMOUNT = #{record.couponAmount,jdbcType=DECIMAL},
      </if>
      <if test="record.payType != null">
        PAY_TYPE = #{record.payType,jdbcType=DECIMAL},
      </if>
      <if test="record.status != null">
        STATUS = #{record.status,jdbcType=DECIMAL},
      </if>
      <if test="record.closeType != null">
        CLOSE_TYPE = #{record.closeType,jdbcType=DECIMAL},
      </if>
      <if test="record.refundStatus != null">
        REFUND_STATUS = #{record.refundStatus,jdbcType=DECIMAL},
      </if>
      <if test="record.productType != null">
        PRODUCT_TYPE = #{record.productType,jdbcType=DECIMAL},
      </if>
      <if test="record.deliveryCompanyName != null">
        DELIVERY_COMPANY_NAME = #{record.deliveryCompanyName,jdbcType=VARCHAR},
      </if>
      <if test="record.deliverySn != null">
        DELIVERY_SN = #{record.deliverySn,jdbcType=VARCHAR},
      </if>
      <if test="record.receiverName != null">
        RECEIVER_NAME = #{record.receiverName,jdbcType=VARCHAR},
      </if>
      <if test="record.receiverPhone != null">
        RECEIVER_PHONE = #{record.receiverPhone,jdbcType=VARCHAR},
      </if>
      <if test="record.receiverProvince != null">
        RECEIVER_PROVINCE = #{record.receiverProvince,jdbcType=VARCHAR},
      </if>
      <if test="record.receiverCity != null">
        RECEIVER_CITY = #{record.receiverCity,jdbcType=VARCHAR},
      </if>
      <if test="record.receiverRegion != null">
        RECEIVER_REGION = #{record.receiverRegion,jdbcType=VARCHAR},
      </if>
      <if test="record.receiverDetailAddress != null">
        RECEIVER_DETAIL_ADDRESS = #{record.receiverDetailAddress,jdbcType=VARCHAR},
      </if>
      <if test="record.note != null">
        NOTE = #{record.note,jdbcType=VARCHAR},
      </if>
      <if test="record.confirmStatus != null">
        CONFIRM_STATUS = #{record.confirmStatus,jdbcType=DECIMAL},
      </if>
      <if test="record.integrationPayFlag != null">
        INTEGRATION_PAY_FLAG = #{record.integrationPayFlag,jdbcType=DECIMAL},
      </if>
      <if test="record.paymentTime != null">
        PAYMENT_TIME = #{record.paymentTime,jdbcType=TIMESTAMP},
      </if>
      <if test="record.deliveryTime != null">
        DELIVERY_TIME = #{record.deliveryTime,jdbcType=TIMESTAMP},
      </if>
      <if test="record.receiveTime != null">
        RECEIVE_TIME = #{record.receiveTime,jdbcType=TIMESTAMP},
      </if>
      <if test="record.rechargeMobile != null">
        RECHARGE_ACCT_NO = #{record.rechargeMobile,jdbcType=VARCHAR},
      </if>
      <if test="record.mobileAddress != null">
        MOBILE_ADDRESS = #{record.mobileAddress,jdbcType=VARCHAR},
      </if>
      <if test="record.noticeStatus != null">
        NOTICE_STATUS = #{record.noticeStatus,jdbcType=DECIMAL},
      </if>
      <if test="record.createTime != null">
        CREATE_TIME = #{record.createTime,jdbcType=TIMESTAMP},
      </if>
      <if test="record.updateTime != null">
        UPDATE_TIME = #{record.updateTime,jdbcType=TIMESTAMP},
      </if>
      <if test="record.reqUrl != null">
        REQ_URL = #{record.reqUrl,jdbcType=VARCHAR},
      </if>
      <if test="record.accessSignId != null">
        ACCESS_SIGN_ID = #{record.accessSignId,jdbcType=VARCHAR},
      </if>
    </set>
    where ORDER_ID = #{record.orderId,jdbcType=DECIMAL}
  </update>

  <select id="selectListByTime" parameterType="com.qdbank.mall.model.order.OrderLikeQueryDO"  resultMap="BaseOrderMap">
    select
    r.PRODUCT_TYPE,
    r.ORDER_SN,
    r.CUST_NO,
    r.CUST_MOBILE,
    r.CREATE_TIME,
    r.PAYMENT_TIME,
    r.RECEIVER_PHONE,
    r.RECEIVER_NAME,
    r.RECEIVER_PROVINCE,
    r.RECEIVER_CITY,
    r.RECEIVER_REGION,
    r.RECEIVER_DETAIL_ADDRESS,
    r.STATUS,
    r.PAY_AMOUNT,
    r.ORDER_INTEGRATION,
    r.FREIGHT_AMOUNT,
    r.COUPON_AMOUNT,
    r.CATEGORY_ID_1,
    r.CATEGORY_ID_2,
    r.CATEGORY_ID_3,
    r.CATEGORY_ID_4,
    r.PRODUCT_ID,
    r.PRODUCT_NAME,
    k.PRODUCT_SP_DATA,
    r.PRODUCT_COUNT,
    r.PRODUCT_CASH,
    r.PRODUCT_INTEGRATION,
    r.MERCHANT_NO,
    r.MERCHANT_NAME,
    m.REFUND_SERIAL,
    p.IDENTIFICATION,
    r.discount_amount
    from OMS_ORDER r
    left join OMS_ORDER_REFUND m on r.ORDER_SN = m.ORDER_SN and  r.REFUND_STATUS=m.REFUND_STATUS and m.REFUND_TYPE != 2
    left join pms_sku_stock k on r.PRODUCT_SKU_ID = k.PRODUCT_SKU_ID
    left join pms_product p on r.PRODUCT_ID = p.PRODUCT_ID
    where 1=1
    <if test="productName != null and productName != ''">
      and r.PRODUCT_NAME like  '%' || #{productName,jdbcType=VARCHAR} || '%'
    </if>
    <if test="merchantName != null">
      and r.MERCHANT_NAME = like  '%' || #{merchantName,jdbcType=VARCHAR} || '%'
    </if>
    <if test="categoryId2 != null">
      and r.CATEGORY_ID_2 =#{categoryId2,jdbcType = DECIMAL}
    </if>
    <if test="merchantNo != null">
      and r.MERCHANT_NO =#{merchantNo,jdbcType = DECIMAL}
    </if>
    <if test="orderSn != null and orderSn != ''">
      and r.ORDER_SN =#{orderSn,jdbcType=VARCHAR}
    </if>
    <if test="custMobile != null">
      and r.CUST_MOBILE =#{custMobile,jdbcType=DECIMAL}
    </if>
    <if test="status != null">
      and r.STATUS =#{status,jdbcType =DECIMAL}
    </if>
    <if test="startTime != null">
      and r.CREATE_TIME &gt;=#{startTime,jdbcType =TIMESTAMP}
    </if>
    <if test="endTime != null">
      and r.CREATE_TIME &lt;=#{endTime,jdbcType =TIMESTAMP}
    </if>
    <if test="productType != null">
      and r.PRODUCT_TYPE =#{productType,jdbcType=DECIMAL}
    </if>
  </select>

  <sql id="Base_Detail_List">
    r.ORDER_ID, r.CUST_NO, r.CUST_NAME, r.CUST_MOBILE, r.MERCHANT_NO, r.MERCHANT_NAME, r.ORDER_SN,
    r.PRODUCT_ID, r.PRODUCT_NAME, r.PRODUCT_SKU_ID, r.PRODUCT_COUNT, r.PRODUCT_PRICE, r.PRODUCT_CASH,
    r.PRODUCT_INTEGRATION, r.CATEGORY_ID_1, r.CATEGORY_ID_2, r.CATEGORY_ID_3, r.CATEGORY_ID_4,
    r.PAY_AMOUNT, r.ORDER_CASH, r.ORDER_INTEGRATION, r.FREIGHT_AMOUNT, r.USER_COUPON_ID, r.COUPON_TYPE,
    r.COUPON_AMOUNT, r.PAY_TYPE, r.STATUS, r.CLOSE_TYPE, r.REFUND_STATUS, r.PRODUCT_TYPE, r.DELIVERY_COMPANY_NAME,
    r.DELIVERY_SN, r.RECEIVER_NAME, r.RECEIVER_PHONE, r.RECEIVER_PROVINCE, r.RECEIVER_CITY, r.RECEIVER_REGION,
    r.RECEIVER_DETAIL_ADDRESS, r.NOTE, r.CONFIRM_STATUS, r.INTEGRATION_PAY_FLAG, r.PAYMENT_TIME,
    r.DELIVERY_TIME, r.RECEIVE_TIME, r.RECHARGE_ACCT_NO, r.MOBILE_ADDRESS, r.NOTICE_STATUS, r.CREATE_TIME,
    r.UPDATE_TIME, r.REQ_URL, r.ACCESS_SIGN_ID, r.INTEGRAL_DEDUCT
  </sql>

  <select id="selectCouponOrderDetail" resultMap="OrderCouponDetailResultMap">
    select
        o.*,
        r.DETAIL_LEVEL as rech_DETAIL_LEVEL,
        r.STATUS as rech_STATUS,
        r.CREATE_TIME as rech_CREATE_TIME
    from
       OMS_ORDER o
    left join oms_recharge_status_detail r on o.ORDER_SN = r.ORDER_SN
    where
        o.ORDER_ID = #{orderId,jdbcType=DECIMAL}


  </select>
  <select id="selectOrderDetail" resultMap="BaseDetailsMap">
    select
    <include refid="Base_Detail_List" />,
    m.CREATE_TIME as REFUND_CREATE_TIME,
    m.REFUND_SERIAL,
    m.REFUND_STATUS as REFUND_REFUND_STATUS,
    m.REFUND_TYPE,
    m.REFUND_AMOUNT,
    p.COUPON_NAME,
    p.COUPON_TYPE as COUPON_COUPON_TYPE,
    p.BATCH_NO,
    p.COUPON_ID,
    p.COUPON_AMOUNT as COUPON_COUPON_AMOUNT,
    d.PRODUCT_NAME as P_PRODUCT_NAME,
    d.MERCHANT_NAME as P_MERCHANT_NAME,
    d.MAIL_PIC_URL,
    k.PRODUCT_SP_DATA,
    de.CREATE_TIME as DETAIL_CREATE_TIME,
    de.STATUS as DETAIL_STATUS
    from OMS_ORDER r
    left join OMS_ORDER_REFUND m on r.ORDER_SN = m.ORDER_SN
    left join pms_product d on r.PRODUCT_ID = d.PRODUCT_ID
    left join pms_sku_stock k on r.PRODUCT_SKU_ID = k.PRODUCT_SKU_ID
    left join sms_user_coupon s on r.USER_COUPON_ID = s.USER_COUPON_ID
    left join sms_coupon p on s.COUPON_ID = p.COUPON_ID
    left join oms_recharge_status_detail de on r.ORDER_SN = de.ORDER_SN
    where r.ORDER_ID =#{orderId,jdbcType=DECIMAL} and m.REFUND_TYPE != 2
  </select>

  <update id="updateByExampleSelective" parameterType="map">
    update OMS_ORDER
    <set>
      <if test="record.orderId != null">
        ORDER_ID = #{record.orderId,jdbcType=DECIMAL},
      </if>
      <if test="record.custNo != null">
        CUST_NO = #{record.custNo,jdbcType=DECIMAL},
      </if>
      <if test="record.custName != null">
        CUST_NAME = #{record.custName,jdbcType=VARCHAR},
      </if>
      <if test="record.custMobile != null">
        CUST_MOBILE = #{record.custMobile,jdbcType=DECIMAL},
      </if>
      <if test="record.merchantNo != null">
        MERCHANT_NO = #{record.merchantNo,jdbcType=DECIMAL},
      </if>
      <if test="record.merchantName != null">
        MERCHANT_NAME = #{record.merchantName,jdbcType=VARCHAR},
      </if>
      <if test="record.orderSn != null">
        ORDER_SN = #{record.orderSn,jdbcType=VARCHAR},
      </if>
      <if test="record.productId != null">
        PRODUCT_ID = #{record.productId,jdbcType=DECIMAL},
      </if>
      <if test="record.productName != null">
        PRODUCT_NAME = #{record.productName,jdbcType=VARCHAR},
      </if>
      <if test="record.productSkuId != null">
        PRODUCT_SKU_ID = #{record.productSkuId,jdbcType=DECIMAL},
      </if>
      <if test="record.productCount != null">
        PRODUCT_COUNT = #{record.productCount,jdbcType=DECIMAL},
      </if>
      <if test="record.productPrice != null">
        PRODUCT_PRICE = #{record.productPrice,jdbcType=DECIMAL},
      </if>
      <if test="record.productCash != null">
        PRODUCT_CASH = #{record.productCash,jdbcType=DECIMAL},
      </if>
      <if test="record.productIntegration != null">
        PRODUCT_INTEGRATION = #{record.productIntegration,jdbcType=DECIMAL},
      </if>
      <if test="record.categoryId1 != null">
        CATEGORY_ID_1 = #{record.categoryId1,jdbcType=DECIMAL},
      </if>
      <if test="record.categoryId2 != null">
        CATEGORY_ID_2 = #{record.categoryId2,jdbcType=DECIMAL},
      </if>
      <if test="record.categoryId3 != null">
        CATEGORY_ID_3 = #{record.categoryId3,jdbcType=DECIMAL},
      </if>
      <if test="record.categoryId4 != null">
        CATEGORY_ID_4 = #{record.categoryId4,jdbcType=DECIMAL},
      </if>
      <if test="record.payAmount != null">
        PAY_AMOUNT = #{record.payAmount,jdbcType=DECIMAL},
      </if>
      <if test="record.orderCash != null">
        ORDER_CASH = #{record.orderCash,jdbcType=DECIMAL},
      </if>
      <if test="record.orderIntegration != null">
        ORDER_INTEGRATION = #{record.orderIntegration,jdbcType=DECIMAL},
      </if>
      <if test="record.freightAmount != null">
        FREIGHT_AMOUNT = #{record.freightAmount,jdbcType=DECIMAL},
      </if>
      <if test="record.userCouponId != null">
        USER_COUPON_ID = #{record.userCouponId,jdbcType=DECIMAL},
      </if>
      <if test="record.couponType != null">
        COUPON_TYPE = #{record.couponType,jdbcType=DECIMAL},
      </if>
      <if test="record.couponAmount != null">
        COUPON_AMOUNT = #{record.couponAmount,jdbcType=DECIMAL},
      </if>
      <if test="record.payType != null">
        PAY_TYPE = #{record.payType,jdbcType=DECIMAL},
      </if>
      <if test="record.status != null">
        STATUS = #{record.status,jdbcType=DECIMAL},
      </if>
      <if test="record.closeType != null">
        CLOSE_TYPE = #{record.closeType,jdbcType=DECIMAL},
      </if>
      <if test="record.refundStatus != null">
        REFUND_STATUS = #{record.refundStatus,jdbcType=DECIMAL},
      </if>
      <if test="record.productType != null">
        PRODUCT_TYPE = #{record.productType,jdbcType=DECIMAL},
      </if>
      <if test="record.deliveryCompanyName != null">
        DELIVERY_COMPANY_NAME = #{record.deliveryCompanyName,jdbcType=VARCHAR},
      </if>
      <if test="record.deliverySn != null">
        DELIVERY_SN = #{record.deliverySn,jdbcType=VARCHAR},
      </if>
      <if test="record.receiverName != null">
        RECEIVER_NAME = #{record.receiverName,jdbcType=VARCHAR},
      </if>
      <if test="record.receiverPhone != null">
        RECEIVER_PHONE = #{record.receiverPhone,jdbcType=VARCHAR},
      </if>
      <if test="record.receiverProvince != null">
        RECEIVER_PROVINCE = #{record.receiverProvince,jdbcType=VARCHAR},
      </if>
      <if test="record.receiverCity != null">
        RECEIVER_CITY = #{record.receiverCity,jdbcType=VARCHAR},
      </if>
      <if test="record.receiverRegion != null">
        RECEIVER_REGION = #{record.receiverRegion,jdbcType=VARCHAR},
      </if>
      <if test="record.receiverDetailAddress != null">
        RECEIVER_DETAIL_ADDRESS = #{record.receiverDetailAddress,jdbcType=VARCHAR},
      </if>
      <if test="record.note != null">
        NOTE = #{record.note,jdbcType=VARCHAR},
      </if>
      <if test="record.confirmStatus != null">
        CONFIRM_STATUS = #{record.confirmStatus,jdbcType=DECIMAL},
      </if>
      <if test="record.integrationPayFlag != null">
        INTEGRATION_PAY_FLAG = #{record.integrationPayFlag,jdbcType=DECIMAL},
      </if>
      <if test="record.paymentTime != null">
        PAYMENT_TIME = #{record.paymentTime,jdbcType=TIMESTAMP},
      </if>
      <if test="record.deliveryTime != null">
        DELIVERY_TIME = #{record.deliveryTime,jdbcType=TIMESTAMP},
      </if>
      <if test="record.receiveTime != null">
        RECEIVE_TIME = #{record.receiveTime,jdbcType=TIMESTAMP},
      </if>
      <if test="record.rechargeMobile != null">
        RECHARGE_ACCT_NO = #{record.rechargeMobile,jdbcType=VARCHAR},
      </if>
      <if test="record.mobileAddress != null">
        MOBILE_ADDRESS = #{record.mobileAddress,jdbcType=VARCHAR},
      </if>
      <if test="record.noticeStatus != null">
        NOTICE_STATUS = #{record.noticeStatus,jdbcType=DECIMAL},
      </if>
      <if test="record.createTime != null">
        CREATE_TIME = #{record.createTime,jdbcType=TIMESTAMP},
      </if>
      <if test="record.updateTime != null">
        UPDATE_TIME = #{record.updateTime,jdbcType=TIMESTAMP},
      </if>
      <if test="record.reqUrl != null">
        REQ_URL = #{record.reqUrl,jdbcType=VARCHAR},
      </if>
      <if test="record.accessSignId != null">
        ACCESS_SIGN_ID = #{record.accessSignId,jdbcType=VARCHAR},
      </if>
    </set>
    <if test="_parameter != null">
      <include refid="Update_By_Example_Where_Clause" />
    </if>
  </update>
  <update id="updateByExample" parameterType="map">
    update OMS_ORDER
    set ORDER_ID = #{record.orderId,jdbcType=DECIMAL},
      CUST_NO = #{record.custNo,jdbcType=DECIMAL},
      CUST_NAME = #{record.custName,jdbcType=VARCHAR},
      CUST_MOBILE = #{record.custMobile,jdbcType=DECIMAL},
      MERCHANT_NO = #{record.merchantNo,jdbcType=DECIMAL},
      MERCHANT_NAME = #{record.merchantName,jdbcType=VARCHAR},
      ORDER_SN = #{record.orderSn,jdbcType=VARCHAR},
      PRODUCT_ID = #{record.productId,jdbcType=DECIMAL},
      PRODUCT_NAME = #{record.productName,jdbcType=VARCHAR},
      PRODUCT_SKU_ID = #{record.productSkuId,jdbcType=DECIMAL},
      PRODUCT_COUNT = #{record.productCount,jdbcType=DECIMAL},
      PRODUCT_PRICE = #{record.productPrice,jdbcType=DECIMAL},
      PRODUCT_CASH = #{record.productCash,jdbcType=DECIMAL},
      PRODUCT_INTEGRATION = #{record.productIntegration,jdbcType=DECIMAL},
      CATEGORY_ID_1 = #{record.categoryId1,jdbcType=DECIMAL},
      CATEGORY_ID_2 = #{record.categoryId2,jdbcType=DECIMAL},
      CATEGORY_ID_3 = #{record.categoryId3,jdbcType=DECIMAL},
      CATEGORY_ID_4 = #{record.categoryId4,jdbcType=DECIMAL},
      PAY_AMOUNT = #{record.payAmount,jdbcType=DECIMAL},
      ORDER_CASH = #{record.orderCash,jdbcType=DECIMAL},
      ORDER_INTEGRATION = #{record.orderIntegration,jdbcType=DECIMAL},
      FREIGHT_AMOUNT = #{record.freightAmount,jdbcType=DECIMAL},
      USER_COUPON_ID = #{record.userCouponId,jdbcType=DECIMAL},
      COUPON_TYPE = #{record.couponType,jdbcType=DECIMAL},
      COUPON_AMOUNT = #{record.couponAmount,jdbcType=DECIMAL},
      PAY_TYPE = #{record.payType,jdbcType=DECIMAL},
      STATUS = #{record.status,jdbcType=DECIMAL},
      CLOSE_TYPE = #{record.closeType,jdbcType=DECIMAL},
      REFUND_STATUS = #{record.refundStatus,jdbcType=DECIMAL},
      PRODUCT_TYPE = #{record.productType,jdbcType=DECIMAL},
      DELIVERY_COMPANY_NAME = #{record.deliveryCompanyName,jdbcType=VARCHAR},
      DELIVERY_SN = #{record.deliverySn,jdbcType=VARCHAR},
      RECEIVER_NAME = #{record.receiverName,jdbcType=VARCHAR},
      RECEIVER_PHONE = #{record.receiverPhone,jdbcType=VARCHAR},
      RECEIVER_PROVINCE = #{record.receiverProvince,jdbcType=VARCHAR},
      RECEIVER_CITY = #{record.receiverCity,jdbcType=VARCHAR},
      RECEIVER_REGION = #{record.receiverRegion,jdbcType=VARCHAR},
      RECEIVER_DETAIL_ADDRESS = #{record.receiverDetailAddress,jdbcType=VARCHAR},
      NOTE = #{record.note,jdbcType=VARCHAR},
      CONFIRM_STATUS = #{record.confirmStatus,jdbcType=DECIMAL},
      INTEGRATION_PAY_FLAG = #{record.integrationPayFlag,jdbcType=DECIMAL},
      PAYMENT_TIME = #{record.paymentTime,jdbcType=TIMESTAMP},
      DELIVERY_TIME = #{record.deliveryTime,jdbcType=TIMESTAMP},
      RECEIVE_TIME = #{record.receiveTime,jdbcType=TIMESTAMP},
      RECHARGE_ACCT_NO = #{record.rechargeMobile,jdbcType=VARCHAR},
      MOBILE_ADDRESS = #{record.mobileAddress,jdbcType=VARCHAR},
      NOTICE_STATUS = #{record.noticeStatus,jdbcType=DECIMAL},
      CREATE_TIME = #{record.createTime,jdbcType=TIMESTAMP},
      UPDATE_TIME = #{record.updateTime,jdbcType=TIMESTAMP},
      REQ_URL = #{record.reqUrl,jdbcType=VARCHAR},
      ACCESS_SIGN_ID = #{record.accessSignId,jdbcType=VARCHAR},
      EXCHANGE_COUPON_ID = #{record.exchangeCouponId,jdbcType=DECIMAL},
      RECHARGE_REMARK = #{record.rechargeRemark,jdbcType=VARCHAR},
      RECHARGE_SEQ = #{record.rechargeSeq,jdbcType=VARCHAR}
    <if test="_parameter != null">
      <include refid="Update_By_Example_Where_Clause" />
    </if>
  </update>

  <select id="selectSaleCount" parameterType="com.qdbank.mall.model.order.OrderDO" resultType="java.lang.Long">
    select
        sum(product_count)
    from
        OMS_ORDER
    where
        PRODUCT_ID = #{record.productId,jdbcType=DECIMAL}
    and
        PRODUCT_SKU_ID = #{record.productSkuId,jdbcType=DECIMAL}
    and
        PAYMENT_TIME is not null
    and
        STATUS != 4
  </select>


  <select id="countProductByExample" parameterType="com.qdbank.mall.model.order.OrderDOExample" resultType="java.lang.Long">
    select  COALESCE(SUM(PRODUCT_COUNT),0)  from OMS_ORDER
    <if test="_parameter != null">
      <include refid="Example_Where_Clause" />
    </if>
  </select>


  <update id="updateByExampleSelectiveForMachineStatus" parameterType="map">
    update OMS_ORDER
    <set>
      STATUS = #{record.status,jdbcType=DECIMAL},
      CLOSE_TYPE = #{record.closeType,jdbcType=DECIMAL},
      REFUND_STATUS = #{record.refundStatus,jdbcType=DECIMAL},
      <if test="record.merchantNo != null">
        MERCHANT_NO = #{record.merchantNo,jdbcType=DECIMAL},
      </if>
      <if test="record.merchantName != null">
        MERCHANT_NAME = #{record.merchantName,jdbcType=VARCHAR},
      </if>
      <if test="record.productId != null">
        PRODUCT_ID = #{record.productId,jdbcType=DECIMAL},
      </if>
      <if test="record.productName != null">
        PRODUCT_NAME = #{record.productName,jdbcType=VARCHAR},
      </if>
      <if test="record.productSkuId != null">
        PRODUCT_SKU_ID = #{record.productSkuId,jdbcType=DECIMAL},
      </if>
      <if test="record.productCount != null">
        PRODUCT_COUNT = #{record.productCount,jdbcType=DECIMAL},
      </if>
      <if test="record.productPrice != null">
        PRODUCT_PRICE = #{record.productPrice,jdbcType=DECIMAL},
      </if>
      <if test="record.productCash != null">
        PRODUCT_CASH = #{record.productCash,jdbcType=DECIMAL},
      </if>
      <if test="record.productIntegration != null">
        PRODUCT_INTEGRATION = #{record.productIntegration,jdbcType=DECIMAL},
      </if>
      <if test="record.categoryId1 != null">
        CATEGORY_ID_1 = #{record.categoryId1,jdbcType=DECIMAL},
      </if>
      <if test="record.categoryId2 != null">
        CATEGORY_ID_2 = #{record.categoryId2,jdbcType=DECIMAL},
      </if>
      <if test="record.categoryId3 != null">
        CATEGORY_ID_3 = #{record.categoryId3,jdbcType=DECIMAL},
      </if>
      <if test="record.categoryId4 != null">
        CATEGORY_ID_4 = #{record.categoryId4,jdbcType=DECIMAL},
      </if>
      <if test="record.payAmount != null">
        PAY_AMOUNT = #{record.payAmount,jdbcType=DECIMAL},
      </if>
      <if test="record.orderCash != null">
        ORDER_CASH = #{record.orderCash,jdbcType=DECIMAL},
      </if>
      <if test="record.orderIntegration != null">
        ORDER_INTEGRATION = #{record.orderIntegration,jdbcType=DECIMAL},
      </if>
      <if test="record.freightAmount != null">
        FREIGHT_AMOUNT = #{record.freightAmount,jdbcType=DECIMAL},
      </if>
      <if test="record.userCouponId != null">
        USER_COUPON_ID = #{record.userCouponId,jdbcType=DECIMAL},
      </if>
      <if test="record.couponType != null">
        COUPON_TYPE = #{record.couponType,jdbcType=DECIMAL},
      </if>
      <if test="record.couponAmount != null">
        COUPON_AMOUNT = #{record.couponAmount,jdbcType=DECIMAL},
      </if>
      <if test="record.payType != null">
        PAY_TYPE = #{record.payType,jdbcType=DECIMAL},
      </if>

      <if test="record.productType != null">
        PRODUCT_TYPE = #{record.productType,jdbcType=DECIMAL},
      </if>
      <if test="record.deliveryCompanyName != null">
        DELIVERY_COMPANY_NAME = #{record.deliveryCompanyName,jdbcType=VARCHAR},
      </if>
      <if test="record.deliverySn != null">
        DELIVERY_SN = #{record.deliverySn,jdbcType=VARCHAR},
      </if>
      <if test="record.receiverName != null">
        RECEIVER_NAME = #{record.receiverName,jdbcType=VARCHAR},
      </if>
      <if test="record.receiverPhone != null">
        RECEIVER_PHONE = #{record.receiverPhone,jdbcType=VARCHAR},
      </if>
      <if test="record.receiverProvince != null">
        RECEIVER_PROVINCE = #{record.receiverProvince,jdbcType=VARCHAR},
      </if>
      <if test="record.receiverCity != null">
        RECEIVER_CITY = #{record.receiverCity,jdbcType=VARCHAR},
      </if>
      <if test="record.receiverRegion != null">
        RECEIVER_REGION = #{record.receiverRegion,jdbcType=VARCHAR},
      </if>
      <if test="record.receiverDetailAddress != null">
        RECEIVER_DETAIL_ADDRESS = #{record.receiverDetailAddress,jdbcType=VARCHAR},
      </if>
      <if test="record.note != null">
        NOTE = #{record.note,jdbcType=VARCHAR},
      </if>
      <if test="record.confirmStatus != null">
        CONFIRM_STATUS = #{record.confirmStatus,jdbcType=DECIMAL},
      </if>
      <if test="record.integrationPayFlag != null">
        INTEGRATION_PAY_FLAG = #{record.integrationPayFlag,jdbcType=DECIMAL},
      </if>
      <if test="record.paymentTime != null">
        PAYMENT_TIME = #{record.paymentTime,jdbcType=TIMESTAMP},
      </if>
      <if test="record.deliveryTime != null">
        DELIVERY_TIME = #{record.deliveryTime,jdbcType=TIMESTAMP},
      </if>
      <if test="record.receiveTime != null">
        RECEIVE_TIME = #{record.receiveTime,jdbcType=TIMESTAMP},
      </if>
      <if test="record.rechargeMobile != null">
        RECHARGE_ACCT_NO = #{record.rechargeMobile,jdbcType=VARCHAR},
      </if>
      <if test="record.mobileAddress != null">
        MOBILE_ADDRESS = #{record.mobileAddress,jdbcType=VARCHAR},
      </if>
      <if test="record.noticeStatus != null">
        NOTICE_STATUS = #{record.noticeStatus,jdbcType=DECIMAL},
      </if>
      <if test="record.createTime != null">
        CREATE_TIME = #{record.createTime,jdbcType=TIMESTAMP},
      </if>
      <if test="record.updateTime != null">
        UPDATE_TIME = #{record.updateTime,jdbcType=TIMESTAMP},
      </if>
      <if test="record.reqUrl != null">
        REQ_URL = #{record.reqUrl,jdbcType=VARCHAR},
      </if>
      <if test="record.accessSignId != null">
        ACCESS_SIGN_ID = #{record.accessSignId,jdbcType=VARCHAR},
      </if>
      <if test="record.rechargeRemark != null">
        RECHARGE_REMARK = #{record.rechargeRemark,jdbcType=VARCHAR},
      </if>
      <if test="record.rechargeSeq != null">
        RECHARGE_SEQ = #{record.rechargeSeq,jdbcType=VARCHAR},
      </if>
    </set>
    <if test="_parameter != null">
      <include refid="Update_By_Example_Where_Clause" />
    </if>
  </update>



  <select id="selectRefundOrderList" resultMap="OrderRefundDetailsMap">
    select
    <include refid="Base_Detail_List" />,
    m.  REFUND_SERIAL,
    m. ORDER_CASH,
    m.ORDER_INTEGRATION,
    m.REFUND_AMOUNT,
    m.REFUND_CASH,
    m. REFUND_INTEGRATION,
    m.REFUND_STATUS,
    m.PRODUCT_TYPE,
    m.HANDLE_START_TIME,
    m.HANDLE_FINISH_TIME,
    m.HANDLE_RESULT,
    m.REASON,
    m.REFUND_TYPE,
    m.PROOF_PICS,
    m.ADMIN_NAME,
    m.EMAIL,
    m.REFUND_NOTE,
    m.CREATE_TIME as REFUND_CREATE_TIME,
    m.REFUND_STATUS as REFUND_REFUND_STATUS
    from OMS_ORDER r
    left join OMS_ORDER_REFUND m on r.ORDER_SN = m.ORDER_SN  and m.REFUND_TYPE != 2
    where 1=1
    <if test="orderId != null">
      and r.ORDER_ID =#{orderId,jdbcType=DECIMAL}
    </if>
    <if test="orderSn != null">
      and r.ORDER_SN =#{orderSn,jdbcType=DECIMAL}
    </if>
    <if test="refundSerial != null">
      and m.REFUND_SERIAL =#{refundSerial,jdbcType=VARCHAR}
    </if>
    order by REFUND_CREATE_TIME desc
  </select>

  <select id="selectStatusCount" parameterType="com.qdbank.mall.model.order.OrderDO" resultType="java.lang.Long">
    select count(1) from OMS_ORDER where REFUND_STATUS = 0
    and MERCHANT_NO =#{merchantNo,jdbcType = DECIMAL}
    union all
    select count(1) from OMS_ORDER where STATUS = 1
    and MERCHANT_NO =#{merchantNo,jdbcType = DECIMAL}
  </select>

  <select id="selectByPrimaryKey" parameterType="java.lang.Long" resultMap="BaseResultMap">
    select
    <include refid="Base_Column_List" />
    from OMS_ORDER
    where ORDER_ID = #{id,jdbcType=DECIMAL}
  </select>

  <select id="selectNotNoticeOrders" resultMap="BaseResultMap">
    select
    <include refid="Base_Column_List" />
    from OMS_ORDER
    where
        CLOSE_TYPE = 1
    and
        STATUS = 4
    and
        NOTICE_STATUS = 0
    and
        CREATE_TIME &lt; sysdate - 30/1440
    and
        CREATE_TIME &gt; sysdate - 1
  </select>

  <select id="selectMobileNotNoticeOrders" resultMap="BaseResultMap">
    select
    <include refid="Base_Column_List" />
    from OMS_ORDER
    where
    STATUS = 6
    and
    PRODUCT_TYPE in (1,2,3)
    and
    PAYMENT_TIME &lt; sysdate - 30/1440
    and
    CREATE_TIME &gt; sysdate - 2
  </select>

  <update id="updateByPrimaryKeySelective" parameterType="com.qdbank.mall.model.order.OrderDO">
    update OMS_ORDER
    <set>
      <if test="custNo != null">
        CUST_NO = #{custNo,jdbcType=DECIMAL},
      </if>
      <if test="custName != null">
        CUST_NAME = #{custName,jdbcType=VARCHAR},
      </if>
      <if test="custMobile != null">
        CUST_MOBILE = #{custMobile,jdbcType=DECIMAL},
      </if>
      <if test="merchantNo != null">
        MERCHANT_NO = #{merchantNo,jdbcType=DECIMAL},
      </if>
      <if test="merchantName != null">
        MERCHANT_NAME = #{merchantName,jdbcType=VARCHAR},
      </if>
      <if test="orderSn != null">
        ORDER_SN = #{orderSn,jdbcType=VARCHAR},
      </if>
      <if test="productId != null">
        PRODUCT_ID = #{productId,jdbcType=DECIMAL},
      </if>
      <if test="productName != null">
        PRODUCT_NAME = #{productName,jdbcType=VARCHAR},
      </if>
      <if test="productSkuId != null">
        PRODUCT_SKU_ID = #{productSkuId,jdbcType=DECIMAL},
      </if>
      <if test="productCount != null">
        PRODUCT_COUNT = #{productCount,jdbcType=DECIMAL},
      </if>
      <if test="productPrice != null">
        PRODUCT_PRICE = #{productPrice,jdbcType=DECIMAL},
      </if>
      <if test="productCash != null">
        PRODUCT_CASH = #{productCash,jdbcType=DECIMAL},
      </if>
      <if test="productIntegration != null">
        PRODUCT_INTEGRATION = #{productIntegration,jdbcType=DECIMAL},
      </if>
      <if test="categoryId1 != null">
        CATEGORY_ID_1 = #{categoryId1,jdbcType=DECIMAL},
      </if>
      <if test="categoryId2 != null">
        CATEGORY_ID_2 = #{categoryId2,jdbcType=DECIMAL},
      </if>
      <if test="categoryId3 != null">
        CATEGORY_ID_3 = #{categoryId3,jdbcType=DECIMAL},
      </if>
      <if test="categoryId4 != null">
        CATEGORY_ID_4 = #{categoryId4,jdbcType=DECIMAL},
      </if>
      <if test="payAmount != null">
        PAY_AMOUNT = #{payAmount,jdbcType=DECIMAL},
      </if>
      <if test="orderCash != null">
        ORDER_CASH = #{orderCash,jdbcType=DECIMAL},
      </if>
      <if test="orderIntegration != null">
        ORDER_INTEGRATION = #{orderIntegration,jdbcType=DECIMAL},
      </if>
      <if test="freightAmount != null">
        FREIGHT_AMOUNT = #{freightAmount,jdbcType=DECIMAL},
      </if>
      <if test="userCouponId != null">
        USER_COUPON_ID = #{userCouponId,jdbcType=DECIMAL},
      </if>
      <if test="couponType != null">
        COUPON_TYPE = #{couponType,jdbcType=DECIMAL},
      </if>
      <if test="couponAmount != null">
        COUPON_AMOUNT = #{couponAmount,jdbcType=DECIMAL},
      </if>
      <if test="payType != null">
        PAY_TYPE = #{payType,jdbcType=DECIMAL},
      </if>
      <if test="status != null">
        STATUS = #{status,jdbcType=DECIMAL},
      </if>
      <if test="closeType != null">
        CLOSE_TYPE = #{closeType,jdbcType=DECIMAL},
      </if>
      <if test="refundStatus != null">
        REFUND_STATUS = #{refundStatus,jdbcType=DECIMAL},
      </if>
      <if test="productType != null">
        PRODUCT_TYPE = #{productType,jdbcType=DECIMAL},
      </if>
      <if test="deliveryCompanyName != null">
        DELIVERY_COMPANY_NAME = #{deliveryCompanyName,jdbcType=VARCHAR},
      </if>
      <if test="deliverySn != null">
        DELIVERY_SN = #{deliverySn,jdbcType=VARCHAR},
      </if>
      <if test="receiverName != null">
        RECEIVER_NAME = #{receiverName,jdbcType=VARCHAR},
      </if>
      <if test="receiverPhone != null">
        RECEIVER_PHONE = #{receiverPhone,jdbcType=VARCHAR},
      </if>
      <if test="receiverProvince != null">
        RECEIVER_PROVINCE = #{receiverProvince,jdbcType=VARCHAR},
      </if>
      <if test="receiverCity != null">
        RECEIVER_CITY = #{receiverCity,jdbcType=VARCHAR},
      </if>
      <if test="receiverRegion != null">
        RECEIVER_REGION = #{receiverRegion,jdbcType=VARCHAR},
      </if>
      <if test="receiverDetailAddress != null">
        RECEIVER_DETAIL_ADDRESS = #{receiverDetailAddress,jdbcType=VARCHAR},
      </if>
      <if test="note != null">
        NOTE = #{note,jdbcType=VARCHAR},
      </if>
      <if test="confirmStatus != null">
        CONFIRM_STATUS = #{confirmStatus,jdbcType=DECIMAL},
      </if>
      <if test="integrationPayFlag != null">
        INTEGRATION_PAY_FLAG = #{integrationPayFlag,jdbcType=DECIMAL},
      </if>
      <if test="paymentTime != null">
        PAYMENT_TIME = #{paymentTime,jdbcType=TIMESTAMP},
      </if>
      <if test="deliveryTime != null">
        DELIVERY_TIME = #{deliveryTime,jdbcType=TIMESTAMP},
      </if>
      <if test="receiveTime != null">
        RECEIVE_TIME = #{receiveTime,jdbcType=TIMESTAMP},
      </if>
      <if test="rechargeMobile != null">
        RECHARGE_ACCT_NO = #{rechargeMobile,jdbcType=VARCHAR},
      </if>
      <if test="mobileAddress != null">
        MOBILE_ADDRESS = #{mobileAddress,jdbcType=VARCHAR},
      </if>
      <if test="noticeStatus != null">
        NOTICE_STATUS = #{noticeStatus,jdbcType=DECIMAL},
      </if>
      <if test="createTime != null">
        CREATE_TIME = #{createTime,jdbcType=TIMESTAMP},
      </if>
      <if test="updateTime != null">
        UPDATE_TIME = #{updateTime,jdbcType=TIMESTAMP},
      </if>
      <if test="reqUrl != null">
        REQ_URL = #{reqUrl,jdbcType=VARCHAR},
      </if>
      <if test="accessSignId != null">
        ACCESS_SIGN_ID = #{accessSignId,jdbcType=VARCHAR},
      </if>
      <if test="exchangeCouponId != null">
        EXCHANGE_COUPON_ID = #{exchangeCouponId,jdbcType=DECIMAL},
      </if>
      <if test="rechargeRemark != null">
        RECHARGE_REMARK = #{rechargeRemark,jdbcType=VARCHAR},
      </if>
      <if test="rechargeSeq != null">
        RECHARGE_SEQ = #{rechargeSeq,jdbcType=VARCHAR},
      </if>
    </set>
    where ORDER_ID = #{orderId,jdbcType=DECIMAL}
  </update>

  <update id="updateOrderStatus" parameterType="java.lang.Integer">
    update
        oms_order t
    set
        t.status = 3, t.confirm_status = 1 ,t.update_time = sysdate
    where
        t.status = 2
    and
        t.delivery_time &lt; sysdate - #{days,jdbcType=INTEGER}

  </update>

  <update id="batchUpdate" parameterType="java.util.List">
    <foreach collection="list" item="item" index="index"  open="begin" close=";end;" separator=";">
      update oms_order
      set
        EXCHANGE_COUPON_ID = #{item.exchangeCouponId,jdbcType=DECIMAL},
        USER_COUPON_ID = #{item.userCouponId,jdbcType=DECIMAL},
        UPDATE_TIME = sysdate
     where
        ORDER_SN = #{item.orderSn,jdbcType=VARCHAR}
    </foreach>
  </update>


  <update id="batchUpdateExpireOrder" parameterType="java.util.List">
    <foreach collection="list" item="item" index="index"  open="begin" close=";end;" separator=";">
      update oms_order
      <set>
        status = 5,
        UPDATE_TIME = sysdate
      </set>
      where
        ORDER_SN = #{item,jdbcType=VARCHAR}
    </foreach>
  </update>

  <select id="selectHasOrderByIntegrealOrderSn" parameterType="string" resultMap="BaseResultMap">
    select
    <include refid="Base_Column_List" />
    from OMS_ORDER
    where CLOSE_TYPE =-1 and  USER_COUPON_ID
    in (select USER_COUPON_ID from MALLDATA.SMS_USER_COUPON a
     where a.ORDER_SN =#{orderSn,jdbcType=VARCHAR} )
  </select>


  <insert id="batchInsertOrder" parameterType="java.util.ArrayList" useGeneratedKeys="false">
    INSERT ALL
    <foreach item="item" index="index" collection="list">
     into OMS_ORDER (ORDER_ID, CUST_NO, CUST_NAME,
      CUST_MOBILE, MERCHANT_NO, MERCHANT_NAME,
      ORDER_SN, PRODUCT_ID, PRODUCT_NAME,
      PRODUCT_SKU_ID, PRODUCT_COUNT, PRODUCT_PRICE,
      PRODUCT_CASH, PRODUCT_INTEGRATION, CATEGORY_ID_1,
      CATEGORY_ID_2, CATEGORY_ID_3, CATEGORY_ID_4,
      PAY_AMOUNT, ORDER_CASH, ORDER_INTEGRATION,
      FREIGHT_AMOUNT, USER_COUPON_ID, COUPON_TYPE,
      COUPON_AMOUNT, PAY_TYPE, STATUS,
      CLOSE_TYPE, REFUND_STATUS, PRODUCT_TYPE,
      DELIVERY_COMPANY_NAME, DELIVERY_SN, RECEIVER_NAME,
      RECEIVER_PHONE, RECEIVER_PROVINCE, RECEIVER_CITY,
      RECEIVER_REGION, RECEIVER_DETAIL_ADDRESS,
      NOTE, CONFIRM_STATUS, INTEGRATION_PAY_FLAG,
      PAYMENT_TIME, DELIVERY_TIME, RECEIVE_TIME,
      RECHARGE_ACCT_NO, MOBILE_ADDRESS, NOTICE_STATUS,
      CREATE_TIME, UPDATE_TIME, REQ_URL,
      ACCESS_SIGN_ID, EXCHANGE_COUPON_ID, RECHARGE_REMARK,
      RECHARGE_SEQ)
      values (#{item.orderId,jdbcType=DECIMAL}, #{item.custNo,jdbcType=DECIMAL}, #{item.custName,jdbcType=VARCHAR},
      #{item.custMobile,jdbcType=DECIMAL}, #{item.merchantNo,jdbcType=DECIMAL}, #{item.merchantName,jdbcType=VARCHAR},
      #{item.orderSn,jdbcType=VARCHAR}, #{item.productId,jdbcType=DECIMAL}, #{item.productName,jdbcType=VARCHAR},
      #{item.productSkuId,jdbcType=DECIMAL}, #{item.productCount,jdbcType=DECIMAL}, #{item.productPrice,jdbcType=DECIMAL},
      #{item.productCash,jdbcType=DECIMAL}, #{item.productIntegration,jdbcType=DECIMAL}, #{item.categoryId1,jdbcType=DECIMAL},
      #{item.categoryId2,jdbcType=DECIMAL}, #{item.categoryId3,jdbcType=DECIMAL}, #{item.categoryId4,jdbcType=DECIMAL},
      #{item.payAmount,jdbcType=DECIMAL}, #{item.orderCash,jdbcType=DECIMAL}, #{item.orderIntegration,jdbcType=DECIMAL},
      #{item.freightAmount,jdbcType=DECIMAL}, #{item.userCouponId,jdbcType=DECIMAL}, #{item.couponType,jdbcType=DECIMAL},
      #{item.couponAmount,jdbcType=DECIMAL}, #{item.payType,jdbcType=DECIMAL}, #{item.status,jdbcType=DECIMAL},
      #{item.closeType,jdbcType=DECIMAL}, #{item.refundStatus,jdbcType=DECIMAL}, #{item.productType,jdbcType=DECIMAL},
      #{item.deliveryCompanyName,jdbcType=VARCHAR}, #{item.deliverySn,jdbcType=VARCHAR}, #{item.receiverName,jdbcType=VARCHAR},
      #{item.receiverPhone,jdbcType=VARCHAR}, #{item.receiverProvince,jdbcType=VARCHAR}, #{item.receiverCity,jdbcType=VARCHAR},
      #{item.receiverRegion,jdbcType=VARCHAR}, #{item.receiverDetailAddress,jdbcType=VARCHAR},
      #{item.note,jdbcType=VARCHAR}, #{item.confirmStatus,jdbcType=DECIMAL}, #{item.integrationPayFlag,jdbcType=DECIMAL},
      #{item.paymentTime,jdbcType=TIMESTAMP}, #{item.deliveryTime,jdbcType=TIMESTAMP}, #{item.receiveTime,jdbcType=TIMESTAMP},
      #{item.rechargeMobile,jdbcType=VARCHAR}, #{item.mobileAddress,jdbcType=VARCHAR}, #{item.noticeStatus,jdbcType=DECIMAL},
      #{item.createTime,jdbcType=TIMESTAMP}, #{item.updateTime,jdbcType=TIMESTAMP}, #{item.reqUrl,jdbcType=VARCHAR},
      #{item.accessSignId,jdbcType=VARCHAR}, #{item.exchangeCouponId,jdbcType=DECIMAL}, #{item.rechargeRemark,jdbcType=VARCHAR},
      #{item.rechargeSeq,jdbcType=VARCHAR})
    </foreach>
    SELECT 1 FROM DUAL
  </insert>


  <select id="selectByRefundSerino" parameterType="string" resultMap="BaseResultMap">
    select
    <include refid="Base_Column_List" />
    from OMS_ORDER
     where order_sn = (select order_sn from OMS_ORDER_REFUND where REFUND_SERIAL= #{refundSerino,jdbcType=DECIMAL})
  </select>

  <update id="updateSendOrderByOrderSn" parameterType="com.qdbank.mall.model.order.OrderImportDO" >
    update
        oms_order
    set
        delivery_sn = #{deliverySn},
        status = 2	,
        delivery_company_name = #{deliveryCompanyName},
        update_time=sysdate	,
        delivery_time=sysdate
    where
        order_sn = #{orderSn}
    and
        REFUND_STATUS in(-1,3,4)
    and
        payment_time is not null
    and
        MERCHANT_NO = #{merchantNo}
    and
        status = 1
  </update>


  <update id="updateStatusByOrderId" parameterType="com.qdbank.mall.model.order.OrderDO">
    update
        oms_order
    set
        delivery_sn = #{record.deliverySn,jdbcType=VARCHAR},
        status = #{record.status,jdbcType=DECIMAL}	,
        delivery_company_name = #{record.deliveryCompanyName,jdbcType=VARCHAR},
        update_time=sysdate	,
        delivery_time=#{record.deliveryTime,jdbcType=TIMESTAMP}
    where ORDER_ID = #{record.orderId,jdbcType=DECIMAL}
  </update>

  <insert id="insertHistoryOrder">
    insert into oms_order_bak
    select * from oms_order
    where to_char(trunc(create_time),'yyyy-mm-dd') = #{endDate}
    and close_type in(0,1,2,3,4)
  </insert>

  <select id="selectHistoryOrders" resultMap="BaseResultMap">
    select
    <include refid="Base_Column_List" />
    from OMS_ORDER
    where to_char(trunc(create_time),'yyyy-mm-dd') = #{endDate}
    and close_type in(0,1,2,3,4)
  </select>
  <update id="updateUserInfo" parameterType="com.qdbank.mall.model.order.OrderDO">
    update OMS_ORDER
    <set>

      <if test="record.receiverName != null">
        RECEIVER_NAME = #{record.receiverName,jdbcType=VARCHAR},
      </if>
      <if test="record.receiverPhone != null">
        RECEIVER_PHONE = #{record.receiverPhone,jdbcType=VARCHAR},
      </if>
      <if test="record.receiverProvince != null">
        RECEIVER_PROVINCE = #{record.receiverProvince,jdbcType=VARCHAR},
      </if>
      <if test="record.receiverCity != null">
        RECEIVER_CITY = #{record.receiverCity,jdbcType=VARCHAR},
      </if>
      <if test="record.receiverRegion != null">
        RECEIVER_REGION = #{record.receiverRegion,jdbcType=VARCHAR},
      </if>
      <if test="record.receiverDetailAddress != null">
        RECEIVER_DETAIL_ADDRESS = #{record.receiverDetailAddress,jdbcType=VARCHAR},
      </if>
      <if test="record.rechargeAccNo != null">
        RECHARGE_ACCT_NO = #{record.rechargeAccNo,jdbcType=VARCHAR},
      </if>
    </set>
    where ORDER_ID = #{record.orderId,jdbcType=DECIMAL}
  </update>


  <insert id="insertHistoryBak">
    insert into oms_order
    select * from oms_order_bak
  </insert>

  <select id="selectHistoryBak" resultMap="BaseResultMap">
    select
    <include refid="Base_Column_List" />
    from OMS_ORDER
    where to_char(trunc(create_time),'yyyy-mm-dd') &lt; '2021-11-12'
    and close_type in(0,1,2,3,4)
  </select>
</mapper>